# 个人中心 - 常用旅客信息需求文档

本文档规范“设置”的页面与交互。

设置页面中左侧有导航栏。点击“订单”应跳转到订单管理页面。
点击“常用信息”，可展开其下的分支。点击“常用旅客信息”，应跳转到常用旅客信息页面。
点击“个人中心”，可展开其下的分支。点击“我的信息”，应跳转到个人信息页面。


## 1. 常用旅客中心

### 1.1 常用信息索引页

**1.1.1 进入方式**
- 登录后，左侧导航点击“常用信息”进入索引页。

**1.1.2 页面元素**
- 四个入口按钮：
  - “常用旅客信息”
  - “常用联系人”
  - “常用报销凭证” 
  - “常用地址” 
- 顶部提示文案：引导选择需要管理的类型。
- 左侧导航保持“常用信息”分组与高亮当前项。

#### Scenario: 索引页正常导航到旅客信息
    Given 用户已登录并打开“常用信息”索引页
    When 用户点击“常用旅客信息”按钮
    Then 跳转至“常用旅客信息列表页”
    And 左侧导航高亮“常用旅客信息”

#### Scenario: 输入异常（无效直达链接）
    Given 用户尝试访问一个不存在的索引子路径
    When 路由匹配失败
    Then 显示404提示或回退到“常用信息”索引页

#### Scenario: 状态异常（未登录）
    Given 用户未登录
    When 用户点击索引页任一入口
    Then 系统要求登录或跳转登录页

#### Scenario: 系统异常（索引资源加载失败）
    Given 索引页需要加载提示数据
    When 接口或资源加载失败
    Then 页面显示“网络异常，请稍后重试”并提供刷新入口

---

### 1.2 常用旅客信息列表页

**1.2.1 进入方式**
- 从“常用信息索引页”点击“常用旅客信息”。

**1.2.2 页面元素**
- 顶部工具栏：
  - 旅客姓名搜索输入框（占位：中文名/英文名）
  - “查询”按钮
  - “新增”按钮（跳转至新增页）
- 数据表格列：
  - 选择框、标识（如“本人”徽标）、姓名、手机/电话、证件类型、证件号码（脱敏）、国籍（国家/地区）、性别、常旅客卡、操作（查看/编辑/删除）
- 表格下方批量操作行：
  - 全选复选框
  - 删除链接（批量删除，当前版本为静态占位）
- 空状态与错误提示区：当无数据或加载异常。

#### Scenario: 列表正常展示与搜索
    Given 页面加载完成并存在至少一条旅客数据
    When 用户在“旅客姓名”输入框填入并点击“查询”
    Then 表格展示匹配的旅客记录
    And 若无匹配则显示“暂无记录”占位

#### Scenario: 输入异常（非法搜索字符）
    Given 用户在搜索框输入仅含特殊字符
    When 用户点击“查询”
    Then 提示“请输入合法的姓名关键字”
    And 保留原列表不变

#### Scenario: 状态异常（本人条目不可删除）
    Given 列表中存在“本人”标识的旅客条目
    When 用户勾选该条并点击“删除”
    Then 系统提示“本人信息不可删除”
    And 取消本次操作

#### Scenario: 系统异常（列表加载失败）
    Given 用户打开列表页
    When 数据接口超时或返回错误
    Then 展示错误提示“加载失败，请稍后重试”
    And 提供“重试”按钮

---

### 1.3 常用旅客信息查看页（只读）

**1.3.1 进入方式**
- 在列表页点击某行“查看”，跳转至路由：`/user-center/common-info/travelers/view`。

**1.3.2 页面元素**
- 段落标题与编号：
  - “1 旅客信息”
  - “2 证件信息”
  - “3 常旅客卡”
- 字段只读展示：
  - 旅客信息：中文名、英文名、国籍（国家/地区）、性别、生日、出生地、手机号、传真号码、Email
  - 证件信息：证件类型、证件号码（脱敏）、有效期
  - 常旅客卡：列表或“未设置”
- 右上角“查看所有旅客信息”链接与底部“返回”。

#### Scenario: 只读展示成功
    Given 用户从列表页点击“查看”进入查看页
    When 页面渲染完成
    Then 所有字段以只读方式展示
    And 提供“返回”链接回到列表页

#### Scenario: 输入异常（无效旅客ID）
    Given 用户通过不合法链接进入查看页
    When 系统无法识别或缺少旅客标识
    Then 展示“记录不存在或链接无效”并提供返回入口

#### Scenario: 状态异常（记录被删除）
    Given 目标旅客记录已被删除
    When 用户打开查看页
    Then 展示“记录已删除”提示
    And 返回列表页

#### Scenario: 系统异常（查看数据加载失败）
    Given 用户打开查看页
    When 接口异常或超时
    Then 展示“加载失败”提示与“重试”入口

---

### 1.4 常用旅客信息编辑页

**1.4.1 进入方式**
- 在列表页点击某行“编辑”，跳转至路由：`/user-center/common-info/travelers/edit`。

**1.4.2 页面元素**
- 旅客信息区：
  - 中文名、英文名（LastName/FirstName）
  - “设置为本人”复选框
  - 国籍（国家/地区）、性别（男/女/未知）、生日（yyyy-MM-dd）、出生地
  - 手机号（国家码选择 + 输入框）、传真号码（区号/电话/分机）、Email
- 证件信息区：
  - 证件类型下拉（身份证/护照等）
  - 证件号码输入框
  - 有效期输入框（yyyy-MM-dd）与“设为长期有效”链接
- 常旅客卡区：添加常旅客卡入口
- 底部按钮：保存、取消

#### Scenario: 编辑并保存成功
    Given 用户在编辑页填写合法信息
    When 用户点击“保存”
    Then 系统校验通过并提示“保存成功”
    And 返回列表页或停留当前页提示已保存

#### Scenario: 输入异常（日期格式错误）
    Given 用户在“生日”或“有效期”中填写非法日期
    When 用户点击“保存”
    Then 提示“日期格式应为 yyyy-MM-dd”
    And 阻止提交

#### Scenario: 状态异常（证件号重复）
    Given 系统已有相同证件类型与证件号的旅客
    When 用户保存
    Then 提示“证件号已存在”
    And 阻止提交

#### Scenario: 系统异常（保存失败）
    Given 用户点击“保存”
    When 后端返回错误或网络超时
    Then 提示“系统繁忙，请稍后重试”
    And 保留用户输入用于再次提交

---

### 1.5 常用旅客信息新增页

**1.5.1 进入方式**
- 在列表页点击“新增”，跳转至路由：`/user-center/common-info/travelers/add`。

**1.5.2 页面元素**
- 旅客信息区：
  - 中文名（必填或与英文名至少一项）
  - 英文名（LastName/FirstName）
  - “设置为本人”复选框
  - 国籍、性别（男/女/未知）、生日、出生地
  - 手机号（国家码选择 + 输入框）、传真号码（区号/电话/分机）、Email
- 证件信息区：
  - 证件类型（默认“请选择”）
  - 证件号码、有效期（yyyy-MM-dd）、“设为长期有效”链接
- 常旅客卡区：添加常旅客卡入口
- 底部按钮：保存、取消

#### Scenario: 新增成功
    Given 用户填写合法且必填项完整
    When 用户点击“保存”
    Then 系统创建旅客记录并提示“新增成功”
    And 跳转回列表页

#### Scenario: 输入异常（必填项缺失）
    Given 中文名与英文名均为空
    When 用户点击“保存”
    Then 提示“中文名与英文名两者至少填写一项”
    And 阻止提交

#### Scenario: 状态异常（本人已存在）
    Given 列表中已存在“本人”标识的旅客
    When 新增页勾选“设置为本人”
    Then 系统提示“已存在本人旅客，不能重复设置”
    And 阻止提交或取消该勾选

#### Scenario: 系统异常（新增失败）
    Given 用户点击“保存”
    When 后端返回错误或网络异常
    Then 提示“系统繁忙，请稍后重试”
    And 保留表单输入以便再次提交

---

### 1.6 列表底部批量操作（全选/删除）

**1.6.1 进入方式**
- 在“常用旅客信息列表页”表格底部操作行。

**1.6.2 页面元素**
- 全选复选框（勾选后选中当前页所有记录）。
- 删除链接（触发批量删除确认弹窗或静态占位）。

#### Scenario: 批量删除正常流程
    Given 用户已勾选多个非“本人”旅客条目
    When 用户点击底部“删除”链接并确认
    Then 系统删除选中条目并刷新列表

#### Scenario: 输入异常（未选择记录）
    Given 用户未勾选任何记录
    When 点击“删除”
    Then 提示“请先选择要删除的记录”
    And 不触发删除动作

#### Scenario: 状态异常（包含不可删除条目）
    Given 勾选集合中包含“本人”或正在被占用的旅客
    When 点击“删除”
    Then 提示“包含不可删除的记录”并标注具体条目
    And 阻止删除

#### Scenario: 系统异常（删除接口失败）
    Given 用户确认删除
    When 后端返回错误
    Then 显示“删除失败，请稍后重试”并保留勾选状态

---

### 1.7 左侧导航一致性

**1.7.1 进入方式**
- 个人中心左侧导航在所有相关页面保持展示。

**1.7.2 页面元素**
- 分组与条目：我的携程首页、常用信息（索引/旅客信息/联系人/报销凭证/地址）、个人中心（我的信息/绑定和关联/账户安全/我的社区主页）。
- 当前页面对应条目高亮，其他为普通态。

#### Scenario: 导航高亮一致
    Given 用户在旅客列表/查看/编辑/新增任一页面
    When 页面渲染完成
    Then 左侧导航应高亮对应条目

## 2. 路由与前端约定
- 列表：`/user-center/common-info/travelers`
- 查看：`/user-center/common-info/travelers/view`
- 编辑：`/user-center/common-info/travelers/edit`
- 新增：`/user-center/common-info/travelers/add`
- 所有页面仅静态展示，不接入后端；交互校验按上述规则提示。

---

## 3. 我的信息页

### 3.1 进入方式
- 登录后，左侧导航“个人中心 → 我的信息”。
- 直接访问路由：`/user-center/my-info`。

### 3.2 页面元素
- 模块区块：
  - “个人信息设置”卡片（标题栏含“收起”链接）：
    - 字段行（只读态）：
      - 手机：脱敏显示，如 `86-138*****3769`，右侧“修改”入口
      - 邮箱：状态文案（如“未填写”）与“验证”入口
      - 昵称：状态文案（如“未设置”）
      - 姓名：状态文案（如“未设置”）
      - 性别：状态文案（如“未设置”）
      - 生日：状态文案（如“未设置”）
    - 右上角“编辑”入口（点击后进入编辑态）
    - 编辑态表单：
      - 昵称（必填）
      - 姓名（必填）
      - 性别（单选：男/女）
      - 生日（输入框，占位 `yyyy-MM-dd`）
      - 底部按钮：`保存`、提示文案“新昵称将在审核后生效”
  - “头像设置”卡片：头像占位图、`编辑`按钮
- 左侧导航分组维持一致（个人中心分组高亮“我的信息”）。

### 3.3 场景描述（Gherkin）

#### Scenario: 查看个人信息（正常流程）
    Given 用户已登录并进入“我的信息”页
    When 页面完成渲染
    Then “个人信息设置”以只读态显示各字段当前值（含脱敏手机与邮箱状态）
    And 显示“编辑”按钮与“头像设置”卡片

#### Scenario: 进入编辑并保存成功（正常流程）
    Given 用户在“我的信息”页点击“编辑”
    And 在编辑态填写有效的“昵称”“姓名”“性别”“生日”
    When 用户点击“保存”
    Then 页面回到只读态并展示更新后的字段值
    And 在昵称下方展示提示“新昵称将在审核后生效”

#### Scenario: 输入异常：昵称为空或超长
    Given 用户进入编辑态
    When 用户将“昵称”留空或长度超过上限（如>20字符）
    Then 页面在“昵称”处提示“请输入昵称（不超过20字符）”
    And 阻止保存

#### Scenario: 输入异常：生日格式错误
    Given 用户进入编辑态
    When 用户在“生日”输入非`yyyy-MM-dd`格式
    Then 在“生日”处提示“日期格式应为 yyyy-MM-dd”
    And 阻止保存

#### Scenario: 状态异常：昵称审核中不可再次编辑
    Given 用户昵称已处于审核中状态
    When 用户点击“编辑”
    Then 显示“昵称审核中，暂不可修改”提示
    And 仅允许修改其他非审核中的字段

#### Scenario: 状态异常：未登录访问
    Given 用户未登录
    When 用户访问“/user-center/my-info”
    Then 系统要求登录或跳转登录页

#### Scenario: 系统异常：保存失败
    Given 用户在编辑态点击“保存”
    When 服务器返回错误或网络超时
    Then 页面提示“保存失败，请稍后重试”
    And 保留用户输入用于再次提交

#### Scenario: 头像编辑入口点击（正常流程）
    Given 用户在“头像设置”卡片
    When 用户点击“编辑”
    Then 打开头像编辑入口（当前版本为静态占位）
    And 可返回“我的信息”页

### 3.4 路由与约定（我的信息）
- 路由：`/user-center/my-info`
- 手机“修改”、邮箱“验证”、头像“编辑”为占位入口；后续版本接入后端时需补充接口契约与校验规则。

### 3.5 我的信息编辑页

**3.5.1 进入方式**
- 在“我的信息”页点击“编辑”进入编辑态（同一路由：`/user-center/my-info`）。
- 可选：通过参数直达编辑态，如 `GET /user-center/my-info?edit=true`（前端路由参数约定）。

**3.5.2 页面元素**
- 顶部标题栏：显示“个人信息设置”，右侧“收起”切换为只读态。
- 字段与控件：
  - 手机：脱敏展示 `86-138*****3769`，右侧“修改”入口（占位动作）。
  - 邮箱：状态文案与“验证”链接（占位动作）。
  - 昵称：文本输入框，必填，长度≤20，提示“新昵称将在审核后生效”。
  - 姓名：文本输入框，必填，长度≤30。
  - 性别：单选框，男/女（二选一）。
  - 生日：文本输入框，占位 `yyyy-mm-dd`，支持基础格式校验。
- 操作按钮：
  - `保存`（主按钮）
  - 说明提示：`新昵称将在审核后生效`

#### Scenario: 编辑并保存成功（正常流程）
    Given 用户在编辑态填写了合法的昵称、姓名、性别与生日
    When 用户点击“保存”按钮
    Then 系统校验通过并更新页面为只读态
    And 显示最新的昵称、姓名、性别与生日
    And 在昵称下方保留提示“新昵称将在审核后生效”

#### Scenario: 输入异常：昵称为空或超长
    Given 用户在编辑态
    When 昵称为空或超过20字符
    Then 在昵称处提示“请输入昵称（不超过20字符）”
    And 阻止保存并保持编辑态

#### Scenario: 输入异常：姓名为空或包含非法字符
    Given 用户在编辑态
    When 姓名为空或包含数字/特殊字符
    Then 在姓名处提示“请输入合法姓名”
    And 阻止保存

#### Scenario: 输入异常：生日格式错误或为未来日期
    Given 用户在编辑态
    When 生日不符合`yyyy-MM-dd`或晚于当前日期
    Then 在生日处提示“日期格式应为 yyyy-MM-dd，且不得为未来日期”
    And 阻止保存

#### Scenario: 状态异常：昵称审核中不可再次修改
    Given 昵称已处于审核中
    When 用户进入编辑态
    Then 昵称输入框置灰不可编辑并显示“审核中”标识
    And 允许编辑其他字段

#### Scenario: 状态异常：未登录访问编辑态
    Given 用户未登录
    When 用户访问`/user-center/my-info?edit=true`
    Then 跳转登录页或提示“请先登录”
    And 登录后回跳编辑态

#### Scenario: 系统异常：保存接口失败
    Given 用户点击“保存”
    When 接口返回错误或超时
    Then 展示“保存失败，请稍后重试”
    And 保留编辑态与已输入内容以便再次提交

#### Scenario: 系统异常：并发覆盖（乐观锁冲突）
    Given 另一个设备已更新用户信息
    When 当前编辑提交后后端返回版本冲突
    Then 提示“信息已被更新，请刷新后重试”
    And 不覆盖最新数据

#### Scenario: 交互：点击“收起”返回只读态
    Given 用户在编辑态
    When 用户点击标题栏右侧“收起”
    Then 页面切换为只读态并显示当前已保存信息

**3.5.3 校验规则与提示**
- 昵称：必填，≤20字符；非法输入提示。
- 姓名：必填，≤30字符；不允许数字与特殊字符。
- 性别：必选其一（男/女）。
- 生日：格式`yyyy-MM-dd`；不得晚于当前日期。
- 提示统一样式与位置，阻止保存时不清空用户输入。

