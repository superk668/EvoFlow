# 携程旅行网 - 登录与注册模块需求文档

## 1. 登录模块

### 1.1 账号密码登录

#### 1.1.1 进入方式
- 用户通过浏览器输入网址直接进入登录页面。
- 用户在首页点击“登录”按钮，也会跳转至登录页面。
- 用户在验证码登录Tab 内，点击切换到“账号登录”按钮。
- 在网站其他需要登录才能操作的页面，若用户未登录，系统会自动跳转至该登录页面。

#### 1.1.2 页面元素
- **登录方式切换**：Tab 形式，包含“账号密码登录”和“验证码登录”，默认为“账号密码登录”。
- **账号输入框**：支持手机号/邮箱/用户名。
- **密码输入框**：密码以密文形式显示。
- **“忘记密码”链接**：点击后跳转至找回密码流程页面。
- **“登录”按钮**：用于提交登录信息。
- **“免费注册”链接**：点击后跳转至注册页面。
- **第三方登录区域**：包含微信、QQ、支付宝、新浪微博、百度等图标链接。
- **服务协议复选框**：“阅读并同意携程的服务协议和个人信息保护政策”，默认为非勾选状态。

---

#### **场景描述 (Gherkin)**

**Scenario: 1.1.3 用户使用有效的账号和密码成功登录**
    Given 用户已打开登录页面
    And 用户已输入注册过的手机号
    And 用户已输入对应的正确密码
    And “服务协议”复选框已被勾选
    When 用户点击“登录”按钮
    Then 系统验证账号和密码匹配
    And 页面跳转至携程首页

**Scenario: 1.1.4 用户使用无效的账号或密码登录失败**
    Given 用户已打开登录页面
    And 用户已输入未注册的手机号
    And 用户已输入任意密码
    And “服务协议”复选框已被勾选
    When 用户点击“登录”按钮
    Then 系统验证账号和密码不匹配
    And 在页面上显示错误提示信息：“用户名或密码不正确”
    And 页面停留在登录页

**Scenario: 1.1.5 用户未输入账号点击登录**
    Given 用户已打开登录页面
    And 用户未输入账号
    When 用户点击“登录”按钮
    Then 系统在账号输入框下方显示错误提示：“请输入用户名”
    And 页面停留在登录页

**Scenario: 1.1.6 用户未输入密码点击登录**
    Given 用户已打开登录页面
    And 用户已输入任意账号
    And 用户未输入密码
    When 用户点击“登录”按钮
    Then 系统在密码输入框下方显示错误提示：“请输入密码”
    And 页面停留在登录页

**Scenario: 1.1.7 用户未勾选服务协议点击登录**
    Given 用户已打开登录页面
    And 用户已输入任意非空的账号和密码
    And 用户未勾选“服务协议”复选框
    When 用户点击“登录”按钮
    Then 系统在复选框上方显示提示信息：“请阅读并同意服务协议”
    And 页面停留在登录页


### 1.2 手机验证码登录

#### 1.2.1 进入方式
- 在“账号密码登录”Tab 内，点击切换到“验证码登录”按钮。

#### 1.2.2 页面元素
- **手机号输入框**：仅支持输入手机号码。
- **“发送验证码”按钮**：点击后向输入的手机号发送短信验证码。
- **验证码输入框**：用于输入收到的6位数字验证码。(验证码的发送方式采用直接从后端终端中输出)
- **“登录”按钮**：用于提交手机号和验证码进行登录。
- **服务协议复选框**：同账号密码登录。
- **账号登录**：点击后跳转至账号密码登录页面。

---

#### **场景描述 (Gherkin)**

**Scenario: 1.2.3 用户使用有效的手机号和验证码成功登录**
    Given 用户已切换到验证码登录方式
    And 用户已输入注册过的手机号
    When 用户点击“发送验证码”按钮
    Then 系统向该手机号发送一条包含6位数字验证码的短信
    And “获取验证码”按钮变为不可点状态，并开始60秒倒计时
    And 用户在验证码输入框中输入了正确的验证码
    When 用户点击“登录”按钮
    Then 系统验证手机号和验证码匹配
    And 页面跳转至携程首页或之前的页面

**Scenario: 1.2.4 用户输入的手机号不合法**
    Given 用户已切换到验证码登录方式
    And 用户输入了一个不合法的手机号，如123
    When 用户点击“发送验证码”按钮
    Then 验证码输入框和登录按钮中间弹出错误提示：手机号格式不正确，请重新输入
    And 页面停留在登录页

**Scenario: 1.2.4 用户输入错误的验证码**
    Given 用户已收到手机验证码
    And 用户在验证码输入框中输入了错误的验证码
    And 用户已勾选“服务协议”复选框
    When 用户点击“登录”按钮
    Then 系统显示错误提示：“验证码不正确”
    And 页面停留在登录页

**Scenario: 1.2.5 用户未勾选服务协议点击登录**
    Given 用户已切换到验证码登录方式
    And 用户已输入合法的手机号
    When 用户点击“发送验证码”按钮
    Then 系统向该手机号发送一条包含6位数字验证码的短信
    And “获取验证码”按钮变为不可点状态，并开始60秒倒计时
    And 用户在验证码输入框中输入了验证码
    And 用户未勾选“服务协议”复选框
    When 用户点击“登录”按钮
    Then 系统显示错误提示：“先请阅读并勾选服务协议”
    And 页面停留在登录页

**Scenario: 1.2.6 用户频繁获取验证码**
    Given 用户已切换到验证码登录方式
    And 用户在60秒内多次点击“获取验证码”按钮
    When 第二次点击“获取验证码”按钮
    Then 按钮无响应，系统不发送新的验证码
    And 倒计时继续

**Scenario: 1.2.7 用户手机号未注册点击登录**
    Given 用户已切换到验证码登录方式
    And 用户已输入未注册的手机号
    When 用户点击“发送验证码”按钮
    Then 系统向该手机号发送一条包含6位数字验证码的短信
    And “获取验证码”按钮变为不可点状态，并开始60秒倒计时
    And 用户在验证码输入框中输入了正确的验证码
    And 用户已勾选“服务协议”复选框
    When 用户点击“登录”按钮
    Then 系统显示错误提示：“该手机号未注册，请先注册”
    And 页面停留在登录页

### 1.3 页面间导航

**Scenario: 1.3.1 登录页跳转至注册页**
    Given 用户处于登录页面
    When 用户点击“免费注册”链接/按钮
    Then 页面跳转至注册页面
    And URL Hash 变为 #register

**Scenario: 1.3.2 注册页跳转至登录页**
    Given 用户处于注册页面
    When 用户点击“已有账号？直接登录”链接/按钮
    Then 页面跳转至登录页面
    And URL Hash 变为 #login


## 2. 注册模块

### 2.1 手机号注册

#### 2.1.1 进入方式
- 在登录页面点击“免费注册”链接。
- 在首页点击“注册”按钮。

#### 2.1.2 页面元素
    - 步骤1：验证手机
        - **手机号输入框**：仅支持输入手机号码。
        - **“发送验证码”按钮**：点击后向输入的手机号发送短信验证码。
        - **短信验证码输入框**：用于输入收到的6位数字验证码。（验证码的发送方式采用在后端终端中直接输出）
        - **“下一步，设置密码”按钮**：点击后提交手机号和验证码进行注册。
    - 步骤2：设置密码
        - **手机号显示栏** ：显示用户已输入的手机号。前三个数字显示，中间四个数字用星号代替，后四个数字显示。
        - **密码输入框**：提示设置8-20位字母、数字和符号组合的密码。
        - **密码强度提示**：实时显示密码的强度，三个并列的矩形 “弱”、“中”、“强”。当密码为输入或不符合要求时，三个矩形均为灰色。当密码符合要求时，根据密码复杂度橙色矩形亮起。当密码强度为“弱”时，只有”弱“矩形亮起；当密码强度为“中”时，”弱“和”中“矩形均亮起；当密码强度为“强”时，三个矩形均亮起。
        - **确认密码输入框**：要求用户再次输入密码以确认。
        - **密码可视化切换按钮**：点击后切换密码输入框的显示状态，显示为明文或密码，默认为密码，用“.”代表字符。
        - **“完成”按钮**：点击后完成注册。
        - **“”<返回上一步“按钮：点击后返回步骤1

---

#### **场景描述 (Gherkin)**

**Scenario: 2.1.3 用户使用有效的手机号和验证码成功进入设置密码步骤2**
    Given 用户已打开注册页面，进入步骤1
    And 用户输入了合法的手机号
    And 用户点击“发送验证码”并收到了验证码
    And 用户输入了正确的验证码
    When 用户点击“下一步，设置密码”按钮
    Then 系统验证所有信息有效
    And 跳转至步骤2，设置密码

**Scenario: 2.1.4 用户输入不合法的手机号**
    Given 用户已打开注册页面，进入步骤1
    And 用户输入了一个不合法的手机号，如123
    When 用户点击“发送验证码”按钮
    Then 验证码输入框和登录按钮中间弹出错误提示：手机号格式不正确，请重新输入，手机号输入栏变成黄色
    And 页面停留在注册页

**Scenario: 2.1.5 用户输入合法的手机号**
    Given 用户已打开注册页面，进入步骤1
    And 用户输入了一个合法的手机号（包含已注册手机号，不需要检查是否已注册）
    When 用户点击“发送验证码”按钮
    Then 系统向该手机号发送一条包含6位数字验证码的短信
    And “获取验证码”按钮变为不可点状态，并开始60秒倒计时

**Scenario: 2.1.6 用户输入错误的验证码**
    Given 用户已填写完手机号和验证码
    And 用户输入了错误的验证码，如123456
    When 用户点击“下一步，设置密码”按钮
    Then 系统在验证码输入框下方显示错误提示：“验证码错误”
    And 页面停留在注册页

**Scenario: 2.1.7 用户输入的两次密码不一致**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户输入了不合法的密码（不是8-20位字母、数字和符号组合）
    Then 密码输入栏显示错误提示：“密码需为8-20位字母、数字和符号的组合”
    And “完成”按钮为不可点击状态

**Scenario: 2.1.8 用户在第一个密码输入栏中输入合法密码**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户在第一个密码输入栏中输入了合法密码（8-20位字母、数字和符号组合）
    Then 密码强度提示栏根据密码强度显示橙色矩形，当密码强度为“弱”时，只有”弱“矩形亮起；当密码强度为“中”时，”弱“和”中“矩形均亮起；当密码强度为“强”时，三个矩形均亮起。

**Scenario: 2.1.9 用户在第二个密码输入栏中输入与第一个密码输入栏中输入的密码不一致的密码**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户在第一个密码输入栏中输入了合法密码（8-20位字母、数字和符号组合）
    And 用户在第二个密码输入栏中输入了与第一个密码输入栏中输入的密码不一致的密码
    Then 密码输入栏显示错误提示：“两次输入密码不一致”
    And “完成”按钮为不可点击状态

**Scenario: 2.1.10 用户点击密码可视化切换按钮**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户在第一个或第二个密码输入栏中输入了任意密码
    When 用户点击某个输入栏对应的密码可视化切换按钮
    Then 该密码输入框的显示状态切换为明文或密码，用“.”代表字符

**Scenario: 2.1.11 用户在未输入任何信息时点击注册**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 所有输入框均为空
    When 用户点击“注册”按钮
    Then 系统在第一个密码框下方显示错误提示：“请设置登录密码”
    And 注册失败，页面停留在注册页

**Scenario: 2.1.12 用户在未输入确认密码时点击注册**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户在第一个密码输入栏中输入了合法密码（8-20位字母、数字和符号组合）
    And 用户在第二个密码输入栏中未输入任何内容
    When 用户点击“注册”按钮
    Then 系统在第二个密码输入框下方显示错误提示：“请再次输入密码”
    And 注册失败，页面停留在注册页

**Scenario: 2.1.13 用户两次输入相同的合法密码**
    Given 用户已填写完手机号和验证码，进入步骤2
    And 用户在第一个密码输入栏中输入了合法密码（8-20位字母、数字和符号组合）
    And 用户在第二个密码输入栏中输入了与第一个密码输入栏中输入的密码相同的密码
    Then 密码强度提示栏根据密码强度显示橙色矩形，当密码强度为“弱”时，只有”弱“矩形亮起；当密码强度为“中”时，”弱“和”中“矩形均亮起；当密码强度为“强”时，三个矩形均亮起。
    And “完成”按钮为可点击状态
    When 用户点击“完成”按钮
    Then 系统注册用户，跳转至登录页

**Scenario: 2.1.14 用户使用已注册手机号注册**
    Given 用户已打开注册页面，进入步骤1
    And 用户输入了已注册的手机号
    When 用户点击“下一步，设置密码”按钮
    Then 系统显示错误提示：“该手机号已注册，请直接登录”
    And 页面停留在注册页步骤1
    Or 用户在步骤2点击“完成”时，系统提示“该手机号已注册”并阻止注册


